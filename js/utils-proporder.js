"use strict";class PropOrder{static getOrdered(a,b,c){c=c||{};const d=PropOrder._PROP_TO_LIST[b];if(!d)throw new Error(`Unhandled prop "${b}"`);return this._getOrdered(a,d,c,b)}static _getOrdered(a,b,c,d){const e={},f=new Set(Object.keys(a)),g=new Set;b.forEach(b=>{if("string"==typeof b)g.add(b),f.has(b)&&(e[b]=a[b]);else{const h=b.key;if(g.add(h),f.has(h)){if(!a[h])return e[h]=a[h];if(b instanceof PropOrder._ObjectKey){const f=`${d}.${h}`;e[h]=b.fnGetOrder?this._getOrdered(a[h],b.fnGetOrder(),c,f):b.order?this._getOrdered(a[h],b.order,c,f):a[h]}else if(b instanceof PropOrder._ArrayKey){const f=`${d}[n].${h}`;e[h]=b.fnGetOrder?a[h].map(a=>this._getOrdered(a,b.fnGetOrder(),c,f)):b.order?a[h].map(a=>this._getOrdered(a,b.order,c,f)):a[h],b.fnSort&&e[h]instanceof Array&&e[h].sort(b.fnSort)}else throw new Error(`Unimplemented!`)}}});const h=CollectionUtil.setDiff(f,g);return[...h].forEach(b=>{e[b]=a[b],c.fnUnhandledKey&&c.fnUnhandledKey(`${d}.${b}`)}),e}static hasOrder(a){return!!PropOrder._PROP_TO_LIST[a]}}PropOrder._ObjectKey=class{constructor(a,b){b=b||{},this.key=a,this.fnGetOrder=b.fnGetOrder,this.order=b.order}},PropOrder._ArrayKey=class{constructor(a,b){b=b||{},this.key=a,this.fnGetOrder=b.fnGetOrder,this.order=b.order,this.fnSort=b.fnSort}},PropOrder._MONSTER=["name","shortName","alias","group","isNpc","isNamedCreature","source","sourceSub","page","srd","otherSources",new PropOrder._ObjectKey("_copy",{order:["name","source","_trait",new PropOrder._ObjectKey("_mod",{fnGetOrder:()=>PropOrder._MONSTER__COPY_MOD}),"_preserve"]}),"level","size","sizeNote","type","alignment","ac","hp","speed","str","dex","con","int","wis","cha","save","skill","senses","passive","resist","immune","vulnerable","conditionImmune","languages","cr","spellcasting","trait","actionNote","action","reaction","legendaryHeader","legendaryActions","legendary","legendaryGroup","variant","environment","fluff","familiar","dragonCastingColor","tokenUrl","soundClip","altArt",new PropOrder._ArrayKey("traitTags",{fnSort:SortUtil.ascSortLower}),new PropOrder._ArrayKey("senseTags",{fnSort:SortUtil.ascSortLower}),new PropOrder._ArrayKey("actionTags",{fnSort:SortUtil.ascSortLower}),new PropOrder._ArrayKey("languageTags",{fnSort:SortUtil.ascSortLower}),new PropOrder._ArrayKey("damageTags",{fnSort:SortUtil.ascSortLower}),new PropOrder._ArrayKey("spellcastingTags",{fnSort:SortUtil.ascSortLower}),new PropOrder._ArrayKey("miscTags",{fnSort:SortUtil.ascSortLower})],PropOrder._MONSTER__COPY_MOD=["*","_",...PropOrder._MONSTER],PropOrder._MONSTER_FLUFF=["name","source","_copy","type","entries","images","_appendCopy"],PropOrder._SPELL=["name","source","page","srd","otherSources","level","school","subschools","time","range","components","duration","meta","entries","entriesHigherLevel","scalingLevelDice","damageResist","damageImmune","damageVulnerable","damageInflict","conditionInflict","spellAttack","savingThrow","opposedCheck","miscTags","areaTags","classes","races","backgrounds"],PropOrder._ACTION=["name","source","page","srd","isOptional","time","entries"],PropOrder._ADVENTURE=["name","id","source","image","published","storyline","level","contents"],PropOrder._BOOK=["name","id","source","image","published","author","contents"],PropOrder._BACKGROUND=["name","source","page","srd","additionalSources","otherSources",new PropOrder._ObjectKey("_copy",{order:["name","source","_trait",new PropOrder._ObjectKey("_mod",{fnGetOrder:()=>PropOrder._BACKGROUND__COPY_MOD}),"_preserve"]}),"entries","skillProficiencies","languageProficiencies","toolProficiencies"],PropOrder._BACKGROUND__COPY_MOD=["*","_",...PropOrder._BACKGROUND],PropOrder._TRAIT=["name","source","page","ref","crMin",new PropOrder._ObjectKey("prerequisite",{order:PropOrder._MONSTER}),new PropOrder._ObjectKey("apply",{order:[new PropOrder._ObjectKey("_root",{order:PropOrder._MONSTER}),new PropOrder._ObjectKey("_mod",{fnGetOrder:()=>PropOrder._MONSTER__COPY_MOD})]})],PropOrder._LEGENDARY_GROUP=["name","source","lairActions","regionalEffects"],PropOrder._CLASS=["name","source","page","srd","isReprinted","hd","proficiency","spellcastingAbility","casterProgression","startingProficiencies","startingEquipment","multiclassing","classTableGroups","classFeatures","subclassTitle",new PropOrder._ArrayKey("subclasses",{fnGetOrder:()=>PropOrder._CLASS__SUBCLASS}),"fluff"],PropOrder._CLASS__SUBCLASS=["name","shortName","source","page","srd","isReprinted","spellcastingAbility","casterProgression","subclassTableGroups","subclassFeatures"],PropOrder._LANGUAGE=["name","dialects","source","page","srd","additionalSources","type","typicalSpeakers","script","entries"],PropOrder._PROP_TO_LIST={monster:PropOrder._MONSTER,monsterFluff:PropOrder._MONSTER_FLUFF,spell:PropOrder._SPELL,action:PropOrder._ACTION,adventure:PropOrder._ADVENTURE,book:PropOrder._BOOK,background:PropOrder._BACKGROUND,trait:PropOrder._TRAIT,legendaryGroup:PropOrder._LEGENDARY_GROUP,class:PropOrder._CLASS,language:PropOrder._LANGUAGE},"undefined"!=typeof module&&(module.exports=PropOrder);