"use strict";class BooksList{static getDateStr(a){if(!a.published)return"\u2014";const b=new Date(a.published);return MiscUtil.dateToStr(b)}constructor(a){this.contentsUrl=a.contentsUrl,this.fnSort=a.fnSort,this.sortByInitial=a.sortByInitial,this.sortDirInitial=a.sortDirInitial,this.dataProp=a.dataProp,this.enhanceRowDataFn=a.enhanceRowDataFn,this.rootPage=a.rootPage,this.rowBuilderFn=a.rowBuilderFn,this.list=null,this.dataIx=0,this.dataList=[]}async pOnPageLoad(){ExcludeUtil.pInitialise();const a=await DataUtil.loadJSON(this.contentsUrl);return this.pOnJsonLoad(a)}async pOnJsonLoad(a){const b=$(`#search`);this.list=new List({$wrpList:$("ul.books"),$iptSearch:b,fnSort:(c,a,b)=>this.fnSort(this.dataList,c,a,b),sortByInitial:this.sortByInitial,sortDirInitial:this.sortDirInitial}),SortUtil.initBtnSortHandlers($(`#filtertools`),this.list),$("#reset").click(()=>{this.list.reset(),$(`.showhide`).each((a,b)=>{const c=$(b);c.data("hidden")||BookUtil.indexListToggle(null,b)})}),this.addData(a);const c=await BrewUtil.pAddBrewData();await handleBrew(c),BrewUtil.bind({list:this.list}),await BrewUtil.pAddLocalBrewData(),BrewUtil.makeBrewButton("manage-brew"),this.list.init(),window.dispatchEvent(new Event("toolsLoaded"))}addData(a){if(a[this.dataProp]&&a[this.dataProp].length){for(this.dataList.push(...a[this.dataProp]);this.dataIx<this.dataList.length;this.dataIx++){const a=this.dataList[this.dataIx];this.enhanceRowDataFn&&this.enhanceRowDataFn(a);const b=document.createElement("li");b.innerHTML=`<a href="${this.rootPage}#${UrlUtil.encodeForHash(a.id)}" class="book-name lst--border">
				<span class="w-100">${this.rowBuilderFn(a)}</span>
				<span class="showhide" onclick="BookUtil.indexListToggle(event, this)" data-hidden="true">[+]</span>
			</a>
			${BookUtil.makeContentsBlock({book:a,addPrefix:this.rootPage,defaultHidden:!0})}`;const c=new ListItem(this.dataIx,b,a.name,{source:a.id},{uniqueId:a.uniqueId});this.list.addItem(c)}this.list.update()}}}