"use strict";class PageFilterItems extends PageFilter{static _rarityValue(a){return"None"===a?0:"Common"===a?1:"Uncommon"===a?2:"Rare"===a?3:"Very Rare"===a?4:"Legendary"===a?5:"Artifact"===a?6:"Other"===a?7:"Varies"===a?8:"Unknown (Magic)"===a?9:"Unknown"===a?10:11}static sortItems(c,a,b){return"name"===b.sortBy?SortUtil.compareListNames(c,a):"type"===b.sortBy?SortUtil.ascSortLower(c.values.type,a.values.type)||SortUtil.compareListNames(c,a):"source"===b.sortBy?SortUtil.ascSortLower(c.values.source,a.values.source)||SortUtil.compareListNames(c,a):"rarity"===b.sortBy?SortUtil.ascSort(PageFilterItems._rarityValue(c.values.rarity),PageFilterItems._rarityValue(a.values.rarity))||SortUtil.compareListNames(c,a):"attunement"===b.sortBy?SortUtil.ascSort(c.values.attunement,a.values.attunement)||SortUtil.compareListNames(c,a):"count"===b.sortBy?SortUtil.ascSort(c.values.count,a.values.count)||SortUtil.compareListNames(c,a):"weight"===b.sortBy?SortUtil.ascSort(c.values.weight,a.values.weight)||SortUtil.compareListNames(c,a):"cost"===b.sortBy?SortUtil.ascSort(c.values.cost,a.values.cost)||SortUtil.compareListNames(c,a):0}constructor(){super();const a=new Filter({header:"Type",deselFn:a=>PageFilterItems._DEFAULT_HIDDEN_TYPES.has(a)}),b=new Filter({header:"Tier",items:["None","Minor","Major"],itemSortFn:null}),c=new Filter({header:"Property",displayFn:StrUtil.uppercaseFirst}),d=new RangeFilter({header:"Cost",min:0,max:100,isAllowGreater:!0,suffix:"gp"}),e=new Filter({header:"Spellcasting Focus",items:["Bard","Cleric","Druid","Paladin","Sorcerer","Warlock","Wizard"]}),f=new Filter({header:"Attached Spells",displayFn:a=>a.split("|")[0].toTitleCase(),itemSortFn:SortUtil.ascSortLower}),g=new Filter({header:"Found On",items:["Magic Item Table A","Magic Item Table B","Magic Item Table C","Magic Item Table D","Magic Item Table E","Magic Item Table F","Magic Item Table G","Magic Item Table H","Magic Item Table I"]}),h=new Filter({header:"Rarity",items:[...Parser.ITEM_RARITIES],itemSortFn:null}),i=new Filter({header:"Attunement",items:["Yes","By...","Optional","No"],itemSortFn:null}),j=new Filter({header:"Category",items:["Basic","Generic Variant","Specific Variant","Other"],deselFn:a=>"Specific Variant"===a,itemSortFn:null}),k=new Filter({header:"Damage Type",displayFn:a=>Parser.dmgTypeToFull(a).uppercaseFirst(),itemSortFn:(c,a)=>SortUtil.ascSortLower(Parser.dmgTypeToFull(c),Parser.dmgTypeToFull(a))}),l=new Filter({header:"Miscellaneous",items:["Ability Score Adjustment","Charges","Cursed","Item Group","Magic","Mundane","Sentient","SRD"]});this._typeFilter=a,this._tierFilter=b,this._propertyFilter=c,this._costFilter=d,this._focusFilter=e,this._attachedSpellsFilter=f,this._lootTableFilter=g,this._rarityFilter=h,this._attunementFilter=i,this._categoryFilter=j,this._damageTypeFilter=k,this._miscFilter=l}mutateForFilters(a){const b=[];b.push(a.tier?a.tier:"None"),a._fTier=b,a._fProperties=a.property?a.property.map(a=>Renderer.item.propertyMap[a].name).filter(a=>a):[],a._fMisc=a.sentient?["Sentient"]:[],a.curse&&a._fMisc.push("Cursed");const c="None"===a.rarity||"Unknown"===a.rarity||"Basic"===a._category;if(a._fMisc.push(c?"Mundane":"Magic"),a._fIsMundane=c,a.ability&&a._fMisc.push("Ability Score Adjustment"),a.charges&&a._fMisc.push("Charges"),a.srd&&a._fMisc.push("SRD"),a._isItemGroup&&a._fMisc.push("Item Group"),(a.focus||"INS"===a.type||"SCF"===a.type)&&(a._fFocus=a.focus?!0===a.focus?["Bard","Cleric","Druid","Paladin","Sorcerer","Warlock","Wizard"]:[...a.focus]:[],"INS"!==a.type||a._fFocus.includes("Bard")||a._fFocus.push("Bard"),"SCF"===a.type))switch(a.scfType){case"arcane":{a._fFocus.includes("Sorcerer")||a._fFocus.push("Sorcerer"),a._fFocus.includes("Warlock")||a._fFocus.push("Warlock"),a._fFocus.includes("Wizard")||a._fFocus.push("Wizard");break}case"druid":{a._fFocus.includes("Druid")||a._fFocus.push("Druid");break}case"holy":a._fFocus.includes("Cleric")||a._fFocus.push("Cleric"),a._fFocus.includes("Paladin")||a._fFocus.push("Paladin");}}addToFilters(a,b){b||(this._sourceFilter.addItem(a.source),this._typeFilter.addItem(a._typeListText),this._tierFilter.addItem(a._fTier),this._propertyFilter.addItem(a._fProperties),this._attachedSpellsFilter.addItem(a.attachedSpells),this._lootTableFilter.addItem(a.lootTables),this._damageTypeFilter.addItem(a.dmgType))}async _pPopulateBoxOptions(a){a.filters=[this._sourceFilter,this._typeFilter,this._tierFilter,this._rarityFilter,this._propertyFilter,this._attunementFilter,this._categoryFilter,this._costFilter,this._focusFilter,this._damageTypeFilter,this._miscFilter,this._lootTableFilter,this._attachedSpellsFilter]}toDisplay(a,b){return this._filterBox.toDisplay(a,b.source,b._typeListText,b._fTier,b.rarity,b._fProperties,b._attunementCategory,b._category,(b.value||0)/100,b._fFocus,b.dmgType,b._fMisc,b.lootTables,b.attachedSpells)}}PageFilterItems._DEFAULT_HIDDEN_TYPES=new Set(["Treasure","Futuristic","Modern","Renaissance"]);class ModalFilterItems extends ModalFilter{constructor(a){super({modalTitle:"Items",pageFilter:new PageFilterItems,namespace:a})}_$getColumnHeaders(){return ModalFilter._$getFilterColumnHeaders([{sort:"name",text:"Name",width:"5"},{sort:"type",text:"Type",width:"5"},{sort:"source",text:"Source",width:"1"}])}async _pLoadAllData(){const a=await BrewUtil.pAddBrewData(),b=await Renderer.item.pBuildList({isAddGroups:!0,isBlacklistVariants:!0}),c=await Renderer.item.getItemsFromHomebrew(a);return[...b,...c]}_getListItem(a,b,c){if(b.noDisplay)return null;Renderer.item.enhanceItem(b),a.mutateAndAddToFilters(b);const d=document.createElement("li");d.className="row px-0";const e=UrlUtil.URL_TO_HASH_BUILDER[UrlUtil.PG_ITEMS](b),f=Parser.sourceJsonToAbv(b.source),g=b._typeListText.join(", ");return d.innerHTML=`<label class="lst--border unselectable">
			<div class="lst__wrp-cells">
				<div class="col-1 pl-0 flex-vh-center"><input type="checkbox" class="no-events"></div>
				<span class="col-5 bold">${b.name}</span>
				<span class="col-5">${g}</span>
				<span class="col-1 text-center ${Parser.sourceJsonToColor(b.source)} pr-0" title="${Parser.sourceJsonToFull(b.source)}" ${BrewUtil.sourceJsonToStyle(b.source)}>${f}</span>
			</div>
		</label>`,new ListItem(c,d,b.name,{hash:e,source:f,sourceJson:b.source,type:g},{cbSel:d.firstElementChild.firstElementChild.firstElementChild.firstElementChild})}}